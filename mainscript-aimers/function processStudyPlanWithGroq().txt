function processStudyPlanWithGroq() {
  // 1. Access the specific sheet
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Form Responses 1");
  
  // 2. Get the last row with content
  const lastRow = sheet.getLastRow();
  
  // Check if the sheet is empty
  if (lastRow < 1) {
    Logger.log("No data found in the sheet.");
    return;
  }

  // 3. Get data from Column K (Index 11)
  const inputData = sheet.getRange(lastRow, 11).getValue();
  
  // Optional: Check if input data exists before calling API
  if (!inputData) {
    Logger.log("Column K is empty for the last row.");
    return;
  }

  // 4. Get the API Key from Script Properties
  // Make sure you have set 'GROQ_API_KEY' in Project Settings > Script Properties
  const apiKey = PropertiesService.getScriptProperties().getProperty("GROQ_API_KEY");
  
  if (!apiKey) {
    throw new Error("GROQ_API_KEY is missing in Script Properties.");
  }

  // 5. Configure the API payload
  // Using the specific model requested: "openai/gpt-oss-120b"
  const payload = {
    model: "openai/gpt-oss-120b", 
    messages: [
      {
        role: "system",
        content: "You are a helpful assistant. Analyze the input and calculate the total minutes to study according to the plan. Return only the numeric value or a brief summary (e.g., '120')."
      },
      {
        role: "user",
        content: `Here is the data: "${inputData}". \n\nQuestion: What is the total minute to study according to plan?`
      }
    ],
    temperature: 0.3 // Lower temperature for more deterministic/factual answers
  };

  // 6. Set up the HTTP request options
  const options = {
    method: "post",
    contentType: "application/json",
    headers: {
      "Authorization": "Bearer " + apiKey
    },
    payload: JSON.stringify(payload),
    muteHttpExceptions: true // Prevents script from crashing on API errors so we can log them
  };

  try {
    // 7. Call the Groq API
    const response = UrlFetchApp.fetch("https://api.groq.com/openai/v1/chat/completions", options);
    const responseCode = response.getResponseCode();
    const responseText = response.getContentText();
    const json = JSON.parse(responseText);

    if (responseCode === 200) {
      // 8. Extract the answer
      const aiOutput = json.choices[0].message.content.trim();
      
      // 9. Write the result to Column G (Index 7)
      sheet.getRange(lastRow, 7).setValue(aiOutput);
      Logger.log("Success! Total minutes written to Column G: " + aiOutput);
    } else {
      Logger.log("API Error (" + responseCode + "): " + responseText);
      sheet.getRange(lastRow, 7).setValue("Error: " + responseCode);
    }

  } catch (e) {
    Logger.log("Script Error: " + e.toString());
    sheet.getRange(lastRow, 7).setValue("Script Error");
  }
}
